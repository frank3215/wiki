<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.2.0" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>$:/library/sjcl.js: OI Index

— by frank3215
</title>
</head>
<body class="tc-body">

<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists tc-tiddler-system " data-tags="" data-tiddler-title="$:/library/sjcl.js"><div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="更多" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="更多动作"></button><div class=" tc-reveal" hidden="true"></div><button aria-label="编辑" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="编辑此条目"></button><button aria-label="关闭" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="关闭此条目"></button></span><span><h2 class="tc-title" title="此为系统条目"><span class="tc-system-title-prefix">$:/</span>library/sjcl.js</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-missing" href=".html"></a></div></div><div class=" tc-reveal">
<div class="tc-tags-wrapper"></div>
</div>

<div class="tc-tiddler-body tc-reveal"><pre class="javascript hljs"><code><span class="hljs-meta">"use strict"</span>;<span class="hljs-keyword">var</span> sjcl={<span class="hljs-attr">cipher</span>:{},<span class="hljs-attr">hash</span>:{},<span class="hljs-attr">keyexchange</span>:{},<span class="hljs-attr">mode</span>:{},<span class="hljs-attr">misc</span>:{},<span class="hljs-attr">codec</span>:{},<span class="hljs-attr">exception</span>:{<span class="hljs-attr">corrupt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.toString=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"CORRUPT: "</span>+<span class="hljs-keyword">this</span>.message};<span class="hljs-keyword">this</span>.message=a},<span class="hljs-attr">invalid</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.toString=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"INVALID: "</span>+<span class="hljs-keyword">this</span>.message};<span class="hljs-keyword">this</span>.message=a},<span class="hljs-attr">bug</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.toString=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"BUG: "</span>+<span class="hljs-keyword">this</span>.message};<span class="hljs-keyword">this</span>.message=a},<span class="hljs-attr">notReady</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.toString=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"NOT READY: "</span>+<span class="hljs-keyword">this</span>.message};<span class="hljs-keyword">this</span>.message=a}}};
sjcl.cipher.aes=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.s[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]||<span class="hljs-keyword">this</span>.O();<span class="hljs-keyword">var</span> b,c,d,e,f=<span class="hljs-keyword">this</span>.s[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>],g=<span class="hljs-keyword">this</span>.s[<span class="hljs-number">1</span>];b=a.length;<span class="hljs-keyword">var</span> h=<span class="hljs-number">1</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">4</span>!==b&amp;&amp;<span class="hljs-number">6</span>!==b&amp;&amp;<span class="hljs-number">8</span>!==b)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"invalid aes key size"</span>);<span class="hljs-keyword">this</span>.b=[d=a.slice(<span class="hljs-number">0</span>),e=[]];<span class="hljs-keyword">for</span>(a=b;a&lt;<span class="hljs-number">4</span>*b+<span class="hljs-number">28</span>;a++){c=d[a<span class="hljs-number">-1</span>];<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===a%b||<span class="hljs-number">8</span>===b&amp;&amp;<span class="hljs-number">4</span>===a%b)c=f[c&gt;&gt;&gt;<span class="hljs-number">24</span>]&lt;&lt;<span class="hljs-number">24</span>^f[c&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">16</span>^f[c&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">8</span>^f[c&amp;<span class="hljs-number">255</span>],<span class="hljs-number">0</span>===a%b&amp;&amp;(c=c&lt;&lt;<span class="hljs-number">8</span>^c&gt;&gt;&gt;<span class="hljs-number">24</span>^h&lt;&lt;<span class="hljs-number">24</span>,h=h&lt;&lt;<span class="hljs-number">1</span>^<span class="hljs-number">283</span>*(h&gt;&gt;<span class="hljs-number">7</span>));d[a]=d[a-b]^c}<span class="hljs-keyword">for</span>(b=<span class="hljs-number">0</span>;a;b++,a--)c=d[b&amp;<span class="hljs-number">3</span>?a:a<span class="hljs-number">-4</span>],e[b]=<span class="hljs-number">4</span>&gt;=a||<span class="hljs-number">4</span>&gt;b?c:g[<span class="hljs-number">0</span>][f[c&gt;&gt;&gt;<span class="hljs-number">24</span>]]^g[<span class="hljs-number">1</span>][f[c&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]]^g[<span class="hljs-number">2</span>][f[c&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]]^g[<span class="hljs-number">3</span>][f[c&amp;
<span class="hljs-number">255</span>]]};
sjcl.cipher.aes.prototype={<span class="hljs-attr">encrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> t(<span class="hljs-keyword">this</span>,a,<span class="hljs-number">0</span>)},<span class="hljs-attr">decrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> t(<span class="hljs-keyword">this</span>,a,<span class="hljs-number">1</span>)},<span class="hljs-attr">s</span>:[[[],[],[],[],[]],[[],[],[],[],[]]],<span class="hljs-attr">O</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">this</span>.s[<span class="hljs-number">0</span>],b=<span class="hljs-keyword">this</span>.s[<span class="hljs-number">1</span>],c=a[<span class="hljs-number">4</span>],d=b[<span class="hljs-number">4</span>],e,f,g,h=[],k=[],l,n,m,p;<span class="hljs-keyword">for</span>(e=<span class="hljs-number">0</span>;<span class="hljs-number">0x100</span>&gt;e;e++)k[(h[e]=e&lt;&lt;<span class="hljs-number">1</span>^<span class="hljs-number">283</span>*(e&gt;&gt;<span class="hljs-number">7</span>))^e]=e;<span class="hljs-keyword">for</span>(f=g=<span class="hljs-number">0</span>;!c[f];f^=l||<span class="hljs-number">1</span>,g=k[g]||<span class="hljs-number">1</span>)<span class="hljs-keyword">for</span>(m=g^g&lt;&lt;<span class="hljs-number">1</span>^g&lt;&lt;<span class="hljs-number">2</span>^g&lt;&lt;<span class="hljs-number">3</span>^g&lt;&lt;<span class="hljs-number">4</span>,m=m&gt;&gt;<span class="hljs-number">8</span>^m&amp;<span class="hljs-number">255</span>^<span class="hljs-number">99</span>,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=<span class="hljs-number">0x1010101</span>*n^<span class="hljs-number">0x10001</span>*e^<span class="hljs-number">0x101</span>*l^<span class="hljs-number">0x1010100</span>*f,n=<span class="hljs-number">0x101</span>*h[m]^<span class="hljs-number">0x1010100</span>*m,e=<span class="hljs-number">0</span>;<span class="hljs-number">4</span>&gt;e;e++)a[e][f]=n=n&lt;&lt;<span class="hljs-number">24</span>^n&gt;&gt;&gt;<span class="hljs-number">8</span>,b[e][m]=p=p&lt;&lt;<span class="hljs-number">24</span>^p&gt;&gt;&gt;<span class="hljs-number">8</span>;<span class="hljs-keyword">for</span>(e=
<span class="hljs-number">0</span>;<span class="hljs-number">5</span>&gt;e;e++)a[e]=a[e].slice(<span class="hljs-number">0</span>),b[e]=b[e].slice(<span class="hljs-number">0</span>)}};
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">4</span>!==b.length)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"invalid aes block size"</span>);<span class="hljs-keyword">var</span> d=a.b[c],e=b[<span class="hljs-number">0</span>]^d[<span class="hljs-number">0</span>],f=b[c?<span class="hljs-number">3</span>:<span class="hljs-number">1</span>]^d[<span class="hljs-number">1</span>],g=b[<span class="hljs-number">2</span>]^d[<span class="hljs-number">2</span>];b=b[c?<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]^d[<span class="hljs-number">3</span>];<span class="hljs-keyword">var</span> h,k,l,n=d.length/<span class="hljs-number">4</span><span class="hljs-number">-2</span>,m,p=<span class="hljs-number">4</span>,r=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>];h=a.s[c];a=h[<span class="hljs-number">0</span>];<span class="hljs-keyword">var</span> q=h[<span class="hljs-number">1</span>],v=h[<span class="hljs-number">2</span>],w=h[<span class="hljs-number">3</span>],x=h[<span class="hljs-number">4</span>];<span class="hljs-keyword">for</span>(m=<span class="hljs-number">0</span>;m&lt;n;m++)h=a[e&gt;&gt;&gt;<span class="hljs-number">24</span>]^q[f&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]^v[g&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]^w[b&amp;<span class="hljs-number">255</span>]^d[p],k=a[f&gt;&gt;&gt;<span class="hljs-number">24</span>]^q[g&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]^v[b&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]^w[e&amp;<span class="hljs-number">255</span>]^d[p+<span class="hljs-number">1</span>],l=a[g&gt;&gt;&gt;<span class="hljs-number">24</span>]^q[b&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]^v[e&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]^w[f&amp;<span class="hljs-number">255</span>]^d[p+<span class="hljs-number">2</span>],b=a[b&gt;&gt;&gt;<span class="hljs-number">24</span>]^q[e&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]^v[f&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]^w[g&amp;<span class="hljs-number">255</span>]^d[p+<span class="hljs-number">3</span>],p+=<span class="hljs-number">4</span>,e=h,f=k,g=l;<span class="hljs-keyword">for</span>(m=
<span class="hljs-number">0</span>;<span class="hljs-number">4</span>&gt;m;m++)r[c?<span class="hljs-number">3</span>&amp;-m:m]=x[e&gt;&gt;&gt;<span class="hljs-number">24</span>]&lt;&lt;<span class="hljs-number">24</span>^x[f&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">16</span>^x[g&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">8</span>^x[b&amp;<span class="hljs-number">255</span>]^d[p++],h=e,e=f,f=g,g=b,b=h;<span class="hljs-keyword">return</span> r}
sjcl.bitArray={<span class="hljs-attr">bitSlice</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{a=sjcl.bitArray.$(a.slice(b/<span class="hljs-number">32</span>),<span class="hljs-number">32</span>-(b&amp;<span class="hljs-number">31</span>)).slice(<span class="hljs-number">1</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===c?a:sjcl.bitArray.clamp(a,c-b)},<span class="hljs-attr">extract</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">var</span> d=<span class="hljs-built_in">Math</span>.floor(-b-c&amp;<span class="hljs-number">31</span>);<span class="hljs-keyword">return</span>((b+c<span class="hljs-number">-1</span>^b)&amp;<span class="hljs-number">-32</span>?a[b/<span class="hljs-number">32</span>|<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">32</span>-d^a[b/<span class="hljs-number">32</span>+<span class="hljs-number">1</span>|<span class="hljs-number">0</span>]&gt;&gt;&gt;d:a[b/<span class="hljs-number">32</span>|<span class="hljs-number">0</span>]&gt;&gt;&gt;d)&amp;(<span class="hljs-number">1</span>&lt;&lt;c)<span class="hljs-number">-1</span>},<span class="hljs-attr">concat</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===a.length||<span class="hljs-number">0</span>===b.length)<span class="hljs-keyword">return</span> a.concat(b);<span class="hljs-keyword">var</span> c=a[a.length<span class="hljs-number">-1</span>],d=sjcl.bitArray.getPartial(c);<span class="hljs-keyword">return</span> <span class="hljs-number">32</span>===d?a.concat(b):sjcl.bitArray.$(b,d,c|<span class="hljs-number">0</span>,a.slice(<span class="hljs-number">0</span>,a.length<span class="hljs-number">-1</span>))},<span class="hljs-attr">bitLength</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b=a.length;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>===
b?<span class="hljs-number">0</span>:<span class="hljs-number">32</span>*(b<span class="hljs-number">-1</span>)+sjcl.bitArray.getPartial(a[b<span class="hljs-number">-1</span>])},<span class="hljs-attr">clamp</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">32</span>*a.length&lt;b)<span class="hljs-keyword">return</span> a;a=a.slice(<span class="hljs-number">0</span>,<span class="hljs-built_in">Math</span>.ceil(b/<span class="hljs-number">32</span>));<span class="hljs-keyword">var</span> c=a.length;b=b&amp;<span class="hljs-number">31</span>;<span class="hljs-number">0</span>&lt;c&amp;&amp;b&amp;&amp;(a[c<span class="hljs-number">-1</span>]=sjcl.bitArray.partial(b,a[c<span class="hljs-number">-1</span>]&amp;<span class="hljs-number">2147483648</span>&gt;&gt;b<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>));<span class="hljs-keyword">return</span> a},<span class="hljs-attr">partial</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-number">32</span>===a?b:(c?b|<span class="hljs-number">0</span>:b&lt;&lt;<span class="hljs-number">32</span>-a)+<span class="hljs-number">0x10000000000</span>*a},<span class="hljs-attr">getPartial</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(a/<span class="hljs-number">0x10000000000</span>)||<span class="hljs-number">32</span>},<span class="hljs-attr">equal</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">if</span>(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))<span class="hljs-keyword">return</span>!<span class="hljs-number">1</span>;<span class="hljs-keyword">var</span> c=<span class="hljs-number">0</span>,d;<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;a.length;d++)c|=a[d]^b[d];<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>===
c},<span class="hljs-attr">$</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d</span>)</span>{<span class="hljs-keyword">var</span> e;e=<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===d&amp;&amp;(d=[]);<span class="hljs-number">32</span>&lt;=b;b-=<span class="hljs-number">32</span>)d.push(c),c=<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===b)<span class="hljs-keyword">return</span> d.concat(a);<span class="hljs-keyword">for</span>(e=<span class="hljs-number">0</span>;e&lt;a.length;e++)d.push(c|a[e]&gt;&gt;&gt;b),c=a[e]&lt;&lt;<span class="hljs-number">32</span>-b;e=a.length?a[a.length<span class="hljs-number">-1</span>]:<span class="hljs-number">0</span>;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&amp;<span class="hljs-number">31</span>,<span class="hljs-number">32</span>&lt;b+a?c:d.pop(),<span class="hljs-number">1</span>));<span class="hljs-keyword">return</span> d},<span class="hljs-attr">i</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">return</span>[a[<span class="hljs-number">0</span>]^b[<span class="hljs-number">0</span>],a[<span class="hljs-number">1</span>]^b[<span class="hljs-number">1</span>],a[<span class="hljs-number">2</span>]^b[<span class="hljs-number">2</span>],a[<span class="hljs-number">3</span>]^b[<span class="hljs-number">3</span>]]},<span class="hljs-attr">byteswapM</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b,c;<span class="hljs-keyword">for</span>(b=<span class="hljs-number">0</span>;b&lt;a.length;++b)c=a[b],a[b]=c&gt;&gt;&gt;<span class="hljs-number">24</span>|c&gt;&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">0xff00</span>|(c&amp;<span class="hljs-number">0xff00</span>)&lt;&lt;<span class="hljs-number">8</span>|c&lt;&lt;<span class="hljs-number">24</span>;<span class="hljs-keyword">return</span> a}};
sjcl.codec.utf8String={<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b=<span class="hljs-string">""</span>,c=sjcl.bitArray.bitLength(a),d,e;<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;c/<span class="hljs-number">8</span>;d++)<span class="hljs-number">0</span>===(d&amp;<span class="hljs-number">3</span>)&amp;&amp;(e=a[d/<span class="hljs-number">4</span>]),b+=<span class="hljs-built_in">String</span>.fromCharCode(e&gt;&gt;&gt;<span class="hljs-number">8</span>&gt;&gt;&gt;<span class="hljs-number">8</span>&gt;&gt;&gt;<span class="hljs-number">8</span>),e&lt;&lt;=<span class="hljs-number">8</span>;<span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-built_in">escape</span>(b))},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=<span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(a));<span class="hljs-keyword">var</span> b=[],c,d=<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;a.length;c++)d=d&lt;&lt;<span class="hljs-number">8</span>|a.charCodeAt(c),<span class="hljs-number">3</span>===(c&amp;<span class="hljs-number">3</span>)&amp;&amp;(b.push(d),d=<span class="hljs-number">0</span>);c&amp;<span class="hljs-number">3</span>&amp;&amp;b.push(sjcl.bitArray.partial(<span class="hljs-number">8</span>*(c&amp;<span class="hljs-number">3</span>),d));<span class="hljs-keyword">return</span> b}};
sjcl.codec.hex={<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b=<span class="hljs-string">""</span>,c;<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;a.length;c++)b+=((a[c]|<span class="hljs-number">0</span>)+<span class="hljs-number">0xf00000000000</span>).toString(<span class="hljs-number">16</span>).substr(<span class="hljs-number">4</span>);<span class="hljs-keyword">return</span> b.substr(<span class="hljs-number">0</span>,sjcl.bitArray.bitLength(a)/<span class="hljs-number">4</span>)},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b,c=[],d;a=a.replace(<span class="hljs-regexp">/\s|0x/g</span>,<span class="hljs-string">""</span>);d=a.length;a=a+<span class="hljs-string">"00000000"</span>;<span class="hljs-keyword">for</span>(b=<span class="hljs-number">0</span>;b&lt;a.length;b+=<span class="hljs-number">8</span>)c.push(<span class="hljs-built_in">parseInt</span>(a.substr(b,<span class="hljs-number">8</span>),<span class="hljs-number">16</span>)^<span class="hljs-number">0</span>);<span class="hljs-keyword">return</span> sjcl.bitArray.clamp(c,<span class="hljs-number">4</span>*d)}};
sjcl.codec.base32={<span class="hljs-attr">B</span>:<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"</span>,<span class="hljs-attr">X</span>:<span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUV"</span>,<span class="hljs-attr">BITS</span>:<span class="hljs-number">32</span>,<span class="hljs-attr">BASE</span>:<span class="hljs-number">5</span>,<span class="hljs-attr">REMAINING</span>:<span class="hljs-number">27</span>,<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">var</span> d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=<span class="hljs-string">""</span>,g=<span class="hljs-number">0</span>,h=sjcl.codec.base32.B,k=<span class="hljs-number">0</span>,l=sjcl.bitArray.bitLength(a);c&amp;&amp;(h=sjcl.codec.base32.X);<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;f.length*d&lt;l;)f+=h.charAt((k^a[c]&gt;&gt;&gt;g)&gt;&gt;&gt;e),g&lt;d?(k=a[c]&lt;&lt;d-g,g+=e,c++):(k&lt;&lt;=d,g-=d);<span class="hljs-keyword">for</span>(;f.length&amp;<span class="hljs-number">7</span>&amp;&amp;!b;)f+=<span class="hljs-string">"="</span>;<span class="hljs-keyword">return</span> f},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{a=a.replace(<span class="hljs-regexp">/\s|=/g</span>,<span class="hljs-string">""</span>).toUpperCase();<span class="hljs-keyword">var</span> c=sjcl.codec.base32.BITS,
d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=<span class="hljs-number">0</span>,k=sjcl.codec.base32.B,l=<span class="hljs-number">0</span>,n,m=<span class="hljs-string">"base32"</span>;b&amp;&amp;(k=sjcl.codec.base32.X,m=<span class="hljs-string">"base32hex"</span>);<span class="hljs-keyword">for</span>(g=<span class="hljs-number">0</span>;g&lt;a.length;g++){n=k.indexOf(a.charAt(g));<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>&gt;n){<span class="hljs-keyword">if</span>(!b)<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> sjcl.codec.base32hex.toBits(a)}<span class="hljs-keyword">catch</span>(p){}<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"this isn't "</span>+m+<span class="hljs-string">"!"</span>);}h&gt;e?(h-=e,f.push(l^n&gt;&gt;&gt;h),l=n&lt;&lt;c-h):(h+=d,l^=n&lt;&lt;c-h)}h&amp;<span class="hljs-number">56</span>&amp;&amp;f.push(sjcl.bitArray.partial(h&amp;<span class="hljs-number">56</span>,l,<span class="hljs-number">1</span>));<span class="hljs-keyword">return</span> f}};
sjcl.codec.base32hex={<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">return</span> sjcl.codec.base32.fromBits(a,b,<span class="hljs-number">1</span>)},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> sjcl.codec.base32.toBits(a,<span class="hljs-number">1</span>)}};
sjcl.codec.base64={<span class="hljs-attr">B</span>:<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>,<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">var</span> d=<span class="hljs-string">""</span>,e=<span class="hljs-number">0</span>,f=sjcl.codec.base64.B,g=<span class="hljs-number">0</span>,h=sjcl.bitArray.bitLength(a);c&amp;&amp;(f=f.substr(<span class="hljs-number">0</span>,<span class="hljs-number">62</span>)+<span class="hljs-string">"-_"</span>);<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;<span class="hljs-number">6</span>*d.length&lt;h;)d+=f.charAt((g^a[c]&gt;&gt;&gt;e)&gt;&gt;&gt;<span class="hljs-number">26</span>),<span class="hljs-number">6</span>&gt;e?(g=a[c]&lt;&lt;<span class="hljs-number">6</span>-e,e+=<span class="hljs-number">26</span>,c++):(g&lt;&lt;=<span class="hljs-number">6</span>,e-=<span class="hljs-number">6</span>);<span class="hljs-keyword">for</span>(;d.length&amp;<span class="hljs-number">3</span>&amp;&amp;!b;)d+=<span class="hljs-string">"="</span>;<span class="hljs-keyword">return</span> d},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{a=a.replace(<span class="hljs-regexp">/\s|=/g</span>,<span class="hljs-string">""</span>);<span class="hljs-keyword">var</span> c=[],d,e=<span class="hljs-number">0</span>,f=sjcl.codec.base64.B,g=<span class="hljs-number">0</span>,h;b&amp;&amp;(f=f.substr(<span class="hljs-number">0</span>,<span class="hljs-number">62</span>)+<span class="hljs-string">"-_"</span>);<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;a.length;d++){h=f.indexOf(a.charAt(d));
<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>&gt;h)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"this isn't base64!"</span>);<span class="hljs-number">26</span>&lt;e?(e-=<span class="hljs-number">26</span>,c.push(g^h&gt;&gt;&gt;e),g=h&lt;&lt;<span class="hljs-number">32</span>-e):(e+=<span class="hljs-number">6</span>,g^=h&lt;&lt;<span class="hljs-number">32</span>-e)}e&amp;<span class="hljs-number">56</span>&amp;&amp;c.push(sjcl.bitArray.partial(e&amp;<span class="hljs-number">56</span>,g,<span class="hljs-number">1</span>));<span class="hljs-keyword">return</span> c}};sjcl.codec.base64url={<span class="hljs-attr">fromBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> sjcl.codec.base64.fromBits(a,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)},<span class="hljs-attr">toBits</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> sjcl.codec.base64.toBits(a,<span class="hljs-number">1</span>)}};sjcl.hash.sha256=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.b[<span class="hljs-number">0</span>]||<span class="hljs-keyword">this</span>.O();a?(<span class="hljs-keyword">this</span>.F=a.F.slice(<span class="hljs-number">0</span>),<span class="hljs-keyword">this</span>.A=a.A.slice(<span class="hljs-number">0</span>),<span class="hljs-keyword">this</span>.l=a.l):<span class="hljs-keyword">this</span>.reset()};sjcl.hash.sha256.hash=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span>(<span class="hljs-keyword">new</span> sjcl.hash.sha256).update(a).finalize()};
sjcl.hash.sha256.prototype={<span class="hljs-attr">blockSize</span>:<span class="hljs-number">512</span>,<span class="hljs-attr">reset</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.F=<span class="hljs-keyword">this</span>.Y.slice(<span class="hljs-number">0</span>);<span class="hljs-keyword">this</span>.A=[];<span class="hljs-keyword">this</span>.l=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>},<span class="hljs-attr">update</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> a&amp;&amp;(a=sjcl.codec.utf8String.toBits(a));<span class="hljs-keyword">var</span> b,c=<span class="hljs-keyword">this</span>.A=sjcl.bitArray.concat(<span class="hljs-keyword">this</span>.A,a);b=<span class="hljs-keyword">this</span>.l;a=<span class="hljs-keyword">this</span>.l=b+sjcl.bitArray.bitLength(a);<span class="hljs-keyword">if</span>(<span class="hljs-number">0x1fffffffffffff</span>&lt;a)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"Cannot hash more than 2^53 - 1 bits"</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Uint32Array</span>){<span class="hljs-keyword">var</span> d=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint32Array</span>(c),e=<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(b=<span class="hljs-number">512</span>+b-(<span class="hljs-number">512</span>+b&amp;<span class="hljs-number">0x1ff</span>);b&lt;=a;b+=<span class="hljs-number">512</span>)u(<span class="hljs-keyword">this</span>,d.subarray(<span class="hljs-number">16</span>*e,
<span class="hljs-number">16</span>*(e+<span class="hljs-number">1</span>))),e+=<span class="hljs-number">1</span>;c.splice(<span class="hljs-number">0</span>,<span class="hljs-number">16</span>*e)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">for</span>(b=<span class="hljs-number">512</span>+b-(<span class="hljs-number">512</span>+b&amp;<span class="hljs-number">0x1ff</span>);b&lt;=a;b+=<span class="hljs-number">512</span>)u(<span class="hljs-keyword">this</span>,c.splice(<span class="hljs-number">0</span>,<span class="hljs-number">16</span>));<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>},<span class="hljs-attr">finalize</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> a,b=<span class="hljs-keyword">this</span>.A,c=<span class="hljs-keyword">this</span>.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)]);<span class="hljs-keyword">for</span>(a=b.length+<span class="hljs-number">2</span>;a&amp;<span class="hljs-number">15</span>;a++)b.push(<span class="hljs-number">0</span>);b.push(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-keyword">this</span>.l/<span class="hljs-number">0x100000000</span>));<span class="hljs-keyword">for</span>(b.push(<span class="hljs-keyword">this</span>.l|<span class="hljs-number">0</span>);b.length;)u(<span class="hljs-keyword">this</span>,b.splice(<span class="hljs-number">0</span>,<span class="hljs-number">16</span>));<span class="hljs-keyword">this</span>.reset();<span class="hljs-keyword">return</span> c},<span class="hljs-attr">Y</span>:[],<span class="hljs-attr">b</span>:[],<span class="hljs-attr">O</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-number">0x100000000</span>*(a-<span class="hljs-built_in">Math</span>.floor(a))|<span class="hljs-number">0</span>}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> b=<span class="hljs-number">0</span>,c=<span class="hljs-number">2</span>,d,e;<span class="hljs-number">64</span>&gt;b;c++){e=!<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(d=<span class="hljs-number">2</span>;d*d&lt;=c;d++)<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===c%d){e=
!<span class="hljs-number">1</span>;<span class="hljs-keyword">break</span>}e&amp;&amp;(<span class="hljs-number">8</span>&gt;b&amp;&amp;(<span class="hljs-keyword">this</span>.Y[b]=a(<span class="hljs-built_in">Math</span>.pow(c,<span class="hljs-number">.5</span>))),<span class="hljs-keyword">this</span>.b[b]=a(<span class="hljs-built_in">Math</span>.pow(c,<span class="hljs-number">1</span>/<span class="hljs-number">3</span>)),b++)}}};
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">u</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c,d,e,f=a.F,g=a.b,h=f[<span class="hljs-number">0</span>],k=f[<span class="hljs-number">1</span>],l=f[<span class="hljs-number">2</span>],n=f[<span class="hljs-number">3</span>],m=f[<span class="hljs-number">4</span>],p=f[<span class="hljs-number">5</span>],r=f[<span class="hljs-number">6</span>],q=f[<span class="hljs-number">7</span>];<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;<span class="hljs-number">64</span>&gt;c;c++)<span class="hljs-number">16</span>&gt;c?d=b[c]:(d=b[c+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>],e=b[c+<span class="hljs-number">14</span>&amp;<span class="hljs-number">15</span>],d=b[c&amp;<span class="hljs-number">15</span>]=(d&gt;&gt;&gt;<span class="hljs-number">7</span>^d&gt;&gt;&gt;<span class="hljs-number">18</span>^d&gt;&gt;&gt;<span class="hljs-number">3</span>^d&lt;&lt;<span class="hljs-number">25</span>^d&lt;&lt;<span class="hljs-number">14</span>)+(e&gt;&gt;&gt;<span class="hljs-number">17</span>^e&gt;&gt;&gt;<span class="hljs-number">19</span>^e&gt;&gt;&gt;<span class="hljs-number">10</span>^e&lt;&lt;<span class="hljs-number">15</span>^e&lt;&lt;<span class="hljs-number">13</span>)+b[c&amp;<span class="hljs-number">15</span>]+b[c+<span class="hljs-number">9</span>&amp;<span class="hljs-number">15</span>]|<span class="hljs-number">0</span>),d=d+q+(m&gt;&gt;&gt;<span class="hljs-number">6</span>^m&gt;&gt;&gt;<span class="hljs-number">11</span>^m&gt;&gt;&gt;<span class="hljs-number">25</span>^m&lt;&lt;<span class="hljs-number">26</span>^m&lt;&lt;<span class="hljs-number">21</span>^m&lt;&lt;<span class="hljs-number">7</span>)+(r^m&amp;(p^r))+g[c],q=r,r=p,p=m,m=n+d|<span class="hljs-number">0</span>,n=l,l=k,k=h,h=d+(k&amp;l^n&amp;(k^l))+(k&gt;&gt;&gt;<span class="hljs-number">2</span>^k&gt;&gt;&gt;<span class="hljs-number">13</span>^k&gt;&gt;&gt;<span class="hljs-number">22</span>^k&lt;&lt;<span class="hljs-number">30</span>^k&lt;&lt;<span class="hljs-number">19</span>^k&lt;&lt;<span class="hljs-number">10</span>)|<span class="hljs-number">0</span>;f[<span class="hljs-number">0</span>]=f[<span class="hljs-number">0</span>]+h|<span class="hljs-number">0</span>;f[<span class="hljs-number">1</span>]=f[<span class="hljs-number">1</span>]+k|<span class="hljs-number">0</span>;f[<span class="hljs-number">2</span>]=f[<span class="hljs-number">2</span>]+l|<span class="hljs-number">0</span>;f[<span class="hljs-number">3</span>]=f[<span class="hljs-number">3</span>]+n|<span class="hljs-number">0</span>;f[<span class="hljs-number">4</span>]=f[<span class="hljs-number">4</span>]+m|<span class="hljs-number">0</span>;f[<span class="hljs-number">5</span>]=f[<span class="hljs-number">5</span>]+p|<span class="hljs-number">0</span>;f[<span class="hljs-number">6</span>]=f[<span class="hljs-number">6</span>]+r|<span class="hljs-number">0</span>;f[<span class="hljs-number">7</span>]=
f[<span class="hljs-number">7</span>]+q|<span class="hljs-number">0</span>}
sjcl.mode.ccm={<span class="hljs-attr">name</span>:<span class="hljs-string">"ccm"</span>,<span class="hljs-attr">G</span>:[],<span class="hljs-attr">listenProgress</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{sjcl.mode.ccm.G.push(a)},<span class="hljs-attr">unListenProgress</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=sjcl.mode.ccm.G.indexOf(a);<span class="hljs-number">-1</span>&lt;a&amp;&amp;sjcl.mode.ccm.G.splice(a,<span class="hljs-number">1</span>)},<span class="hljs-attr">fa</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b=sjcl.mode.ccm.G.slice(),c;<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;b.length;c+=<span class="hljs-number">1</span>)b[c](a)},<span class="hljs-attr">encrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e</span>)</span>{<span class="hljs-keyword">var</span> f,g=b.slice(<span class="hljs-number">0</span>),h=sjcl.bitArray,k=h.bitLength(c)/<span class="hljs-number">8</span>,l=h.bitLength(g)/<span class="hljs-number">8</span>;e=e||<span class="hljs-number">64</span>;d=d||[];<span class="hljs-keyword">if</span>(<span class="hljs-number">7</span>&gt;k)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"ccm: iv must be at least 7 bytes"</span>);<span class="hljs-keyword">for</span>(f=<span class="hljs-number">2</span>;<span class="hljs-number">4</span>&gt;f&amp;&amp;l&gt;&gt;&gt;<span class="hljs-number">8</span>*f;f++);f&lt;<span class="hljs-number">15</span>-k&amp;&amp;(f=<span class="hljs-number">15</span>-k);c=h.clamp(c,
<span class="hljs-number">8</span>*(<span class="hljs-number">15</span>-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);<span class="hljs-keyword">return</span> h.concat(g.data,g.tag)},<span class="hljs-attr">decrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e</span>)</span>{e=e||<span class="hljs-number">64</span>;d=d||[];<span class="hljs-keyword">var</span> f=sjcl.bitArray,g=f.bitLength(c)/<span class="hljs-number">8</span>,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/<span class="hljs-number">8</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">7</span>&gt;g)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"ccm: iv must be at least 7 bytes"</span>);<span class="hljs-keyword">for</span>(b=<span class="hljs-number">2</span>;<span class="hljs-number">4</span>&gt;b&amp;&amp;h&gt;&gt;&gt;<span class="hljs-number">8</span>*b;b++);b&lt;<span class="hljs-number">15</span>-g&amp;&amp;(b=<span class="hljs-number">15</span>-g);c=f.clamp(c,<span class="hljs-number">8</span>*(<span class="hljs-number">15</span>-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);<span class="hljs-keyword">if</span>(!f.equal(k.tag,a))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.corrupt(<span class="hljs-string">"ccm: tag doesn't match"</span>);
<span class="hljs-keyword">return</span> k.data},<span class="hljs-attr">na</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">var</span> g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(<span class="hljs-number">8</span>,(b.length?<span class="hljs-number">64</span>:<span class="hljs-number">0</span>)|d<span class="hljs-number">-2</span>&lt;&lt;<span class="hljs-number">2</span>|f<span class="hljs-number">-1</span>)];d=h.concat(d,c);d[<span class="hljs-number">3</span>]|=e;d=a.encrypt(d);<span class="hljs-keyword">if</span>(b.length)<span class="hljs-keyword">for</span>(c=h.bitLength(b)/<span class="hljs-number">8</span>,<span class="hljs-number">65279</span>&gt;=c?g=[h.partial(<span class="hljs-number">16</span>,c)]:<span class="hljs-number">0xffffffff</span>&gt;=c&amp;&amp;(g=h.concat([h.partial(<span class="hljs-number">16</span>,<span class="hljs-number">65534</span>)],[c])),g=h.concat(g,b),b=<span class="hljs-number">0</span>;b&lt;g.length;b+=<span class="hljs-number">4</span>)d=a.encrypt(k(d,g.slice(b,b+<span class="hljs-number">4</span>).concat([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])));<span class="hljs-keyword">return</span> d},<span class="hljs-attr">V</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">var</span> g=sjcl.bitArray,h=g.i;e/=<span class="hljs-number">8</span>;<span class="hljs-keyword">if</span>(e%<span class="hljs-number">2</span>||<span class="hljs-number">4</span>&gt;e||<span class="hljs-number">16</span>&lt;e)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"ccm: invalid tag length"</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-number">0xffffffff</span>&lt;d.length||<span class="hljs-number">0xffffffff</span>&lt;b.length)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.bug(<span class="hljs-string">"ccm: can't deal with 4GiB or more data"</span>);c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/<span class="hljs-number">8</span>,f);<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;b.length;d+=<span class="hljs-number">4</span>)c=a.encrypt(h(c,b.slice(d,d+<span class="hljs-number">4</span>).concat([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])));<span class="hljs-keyword">return</span> g.clamp(c,<span class="hljs-number">8</span>*e)},<span class="hljs-attr">C</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">var</span> g,h=sjcl.bitArray;g=h.i;<span class="hljs-keyword">var</span> k=b.length,l=h.bitLength(b),n=k/<span class="hljs-number">50</span>,m=n;c=h.concat([h.partial(<span class="hljs-number">8</span>,f<span class="hljs-number">-1</span>)],c).concat([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]).slice(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>);d=h.bitSlice(g(d,a.encrypt(c)),<span class="hljs-number">0</span>,e);<span class="hljs-keyword">if</span>(!k)<span class="hljs-keyword">return</span>{<span class="hljs-attr">tag</span>:d,<span class="hljs-attr">data</span>:[]};<span class="hljs-keyword">for</span>(g=<span class="hljs-number">0</span>;g&lt;k;g+=<span class="hljs-number">4</span>)g&gt;n&amp;&amp;(sjcl.mode.ccm.fa(g/
k),n+=m),c[<span class="hljs-number">3</span>]++,e=a.encrypt(c),b[g]^=e[<span class="hljs-number">0</span>],b[g+<span class="hljs-number">1</span>]^=e[<span class="hljs-number">1</span>],b[g+<span class="hljs-number">2</span>]^=e[<span class="hljs-number">2</span>],b[g+<span class="hljs-number">3</span>]^=e[<span class="hljs-number">3</span>];<span class="hljs-keyword">return</span>{<span class="hljs-attr">tag</span>:d,<span class="hljs-attr">data</span>:h.clamp(b,l)}}};
sjcl.mode.ocb2={<span class="hljs-attr">name</span>:<span class="hljs-string">"ocb2"</span>,<span class="hljs-attr">encrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">128</span>!==sjcl.bitArray.bitLength(c))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"ocb iv must be 128 bits"</span>);<span class="hljs-keyword">var</span> g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>];c=h(a.encrypt(c));<span class="hljs-keyword">var</span> m,p=[];d=d||[];e=e||<span class="hljs-number">64</span>;<span class="hljs-keyword">for</span>(g=<span class="hljs-number">0</span>;g+<span class="hljs-number">4</span>&lt;b.length;g+=<span class="hljs-number">4</span>)m=b.slice(g,g+<span class="hljs-number">4</span>),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,b]));m=k.clamp(l(m.concat([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]),g),b);n=l(n,l(m.concat([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]),g));n=a.encrypt(l(n,l(c,h(c))));
d.length&amp;&amp;(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));<span class="hljs-keyword">return</span> p.concat(k.concat(m,k.clamp(n,e)))},<span class="hljs-attr">decrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">128</span>!==sjcl.bitArray.bitLength(c))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"ocb iv must be 128 bits"</span>);e=e||<span class="hljs-number">64</span>;<span class="hljs-keyword">var</span> g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c+<span class="hljs-number">4</span>&lt;r/<span class="hljs-number">32</span>;c+=<span class="hljs-number">4</span>)m=k(n,a.decrypt(k(n,b.slice(c,c+<span class="hljs-number">4</span>)))),l=k(l,m),q=q.concat(m),n=g(n);p=r<span class="hljs-number">-32</span>*c;m=a.encrypt(k(n,[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]));m=k(m,h.clamp(b.slice(c),p).concat([<span class="hljs-number">0</span>,
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&amp;&amp;(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));<span class="hljs-keyword">if</span>(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.corrupt(<span class="hljs-string">"ocb: tag doesn't match"</span>);<span class="hljs-keyword">return</span> q.concat(h.clamp(m,p))},<span class="hljs-attr">pmac</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],h=a.encrypt([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]),h=f(h,d(d(h)));<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c+<span class="hljs-number">4</span>&lt;b.length;c+=<span class="hljs-number">4</span>)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+<span class="hljs-number">4</span>))));c=b.slice(c);<span class="hljs-number">128</span>&gt;e.bitLength(c)&amp;&amp;(h=f(h,d(h)),c=e.concat(c,[<span class="hljs-number">-2147483648</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]));g=f(g,c);
<span class="hljs-keyword">return</span> a.encrypt(f(d(f(h,d(h))),g))},<span class="hljs-attr">S</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">return</span>[a[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">1</span>^a[<span class="hljs-number">1</span>]&gt;&gt;&gt;<span class="hljs-number">31</span>,a[<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">1</span>^a[<span class="hljs-number">2</span>]&gt;&gt;&gt;<span class="hljs-number">31</span>,a[<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">1</span>^a[<span class="hljs-number">3</span>]&gt;&gt;&gt;<span class="hljs-number">31</span>,a[<span class="hljs-number">3</span>]&lt;&lt;<span class="hljs-number">1</span>^<span class="hljs-number">135</span>*(a[<span class="hljs-number">0</span>]&gt;&gt;&gt;<span class="hljs-number">31</span>)]}};
sjcl.mode.gcm={<span class="hljs-attr">name</span>:<span class="hljs-string">"gcm"</span>,<span class="hljs-attr">encrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e</span>)</span>{<span class="hljs-keyword">var</span> f=b.slice(<span class="hljs-number">0</span>);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(!<span class="hljs-number">0</span>,a,f,d,c,e||<span class="hljs-number">128</span>);<span class="hljs-keyword">return</span> b.concat(a.data,a.tag)},<span class="hljs-attr">decrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e</span>)</span>{<span class="hljs-keyword">var</span> f=b.slice(<span class="hljs-number">0</span>),g=sjcl.bitArray,h=g.bitLength(f);e=e||<span class="hljs-number">128</span>;d=d||[];e&lt;=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,<span class="hljs-number">0</span>,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(!<span class="hljs-number">1</span>,a,f,d,c,e);<span class="hljs-keyword">if</span>(!g.equal(a.tag,b))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.corrupt(<span class="hljs-string">"gcm: tag doesn't match"</span>);<span class="hljs-keyword">return</span> a.data},<span class="hljs-attr">ka</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c,d,e,f,g,h=sjcl.bitArray.i;e=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>];f=b.slice(<span class="hljs-number">0</span>);<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;<span class="hljs-number">128</span>&gt;c;c++){(d=<span class="hljs-number">0</span>!==(a[<span class="hljs-built_in">Math</span>.floor(c/<span class="hljs-number">32</span>)]&amp;<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">31</span>-c%<span class="hljs-number">32</span>))&amp;&amp;(e=h(e,f));g=<span class="hljs-number">0</span>!==(f[<span class="hljs-number">3</span>]&amp;<span class="hljs-number">1</span>);<span class="hljs-keyword">for</span>(d=<span class="hljs-number">3</span>;<span class="hljs-number">0</span>&lt;d;d--)f[d]=f[d]&gt;&gt;&gt;<span class="hljs-number">1</span>|(f[d<span class="hljs-number">-1</span>]&amp;<span class="hljs-number">1</span>)&lt;&lt;<span class="hljs-number">31</span>;f[<span class="hljs-number">0</span>]&gt;&gt;&gt;=<span class="hljs-number">1</span>;g&amp;&amp;(f[<span class="hljs-number">0</span>]^=<span class="hljs-number">-0x1f000000</span>)}<span class="hljs-keyword">return</span> e},<span class="hljs-attr">j</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">var</span> d,e=c.length;b=b.slice(<span class="hljs-number">0</span>);<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;e;d+=<span class="hljs-number">4</span>)b[<span class="hljs-number">0</span>]^=<span class="hljs-number">0xffffffff</span>&amp;c[d],b[<span class="hljs-number">1</span>]^=<span class="hljs-number">0xffffffff</span>&amp;c[d+<span class="hljs-number">1</span>],b[<span class="hljs-number">2</span>]^=<span class="hljs-number">0xffffffff</span>&amp;c[d+<span class="hljs-number">2</span>],b[<span class="hljs-number">3</span>]^=<span class="hljs-number">0xffffffff</span>&amp;c[d+<span class="hljs-number">3</span>],b=sjcl.mode.gcm.ka(b,a);<span class="hljs-keyword">return</span> b},<span class="hljs-attr">C</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e,f</span>)</span>{<span class="hljs-keyword">var</span> g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);
g=b.encrypt([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]);<span class="hljs-number">96</span>===h?(e=e.slice(<span class="hljs-number">0</span>),e=q.concat(e,[<span class="hljs-number">1</span>])):(e=sjcl.mode.gcm.j(g,[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],e),e=sjcl.mode.gcm.j(g,e,[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-built_in">Math</span>.floor(h/<span class="hljs-number">0x100000000</span>),h&amp;<span class="hljs-number">0xffffffff</span>]));h=sjcl.mode.gcm.j(g,[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],d);n=e.slice(<span class="hljs-number">0</span>);d=h.slice(<span class="hljs-number">0</span>);a||(d=sjcl.mode.gcm.j(g,h,c));<span class="hljs-keyword">for</span>(l=<span class="hljs-number">0</span>;l&lt;m;l+=<span class="hljs-number">4</span>)n[<span class="hljs-number">3</span>]++,k=b.encrypt(n),c[l]^=k[<span class="hljs-number">0</span>],c[l+<span class="hljs-number">1</span>]^=k[<span class="hljs-number">1</span>],c[l+<span class="hljs-number">2</span>]^=k[<span class="hljs-number">2</span>],c[l+<span class="hljs-number">3</span>]^=k[<span class="hljs-number">3</span>];c=q.clamp(c,p);a&amp;&amp;(d=sjcl.mode.gcm.j(g,h,c));a=[<span class="hljs-built_in">Math</span>.floor(r/<span class="hljs-number">0x100000000</span>),r&amp;<span class="hljs-number">0xffffffff</span>,<span class="hljs-built_in">Math</span>.floor(p/<span class="hljs-number">0x100000000</span>),p&amp;<span class="hljs-number">0xffffffff</span>];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);
d[<span class="hljs-number">0</span>]^=k[<span class="hljs-number">0</span>];d[<span class="hljs-number">1</span>]^=k[<span class="hljs-number">1</span>];d[<span class="hljs-number">2</span>]^=k[<span class="hljs-number">2</span>];d[<span class="hljs-number">3</span>]^=k[<span class="hljs-number">3</span>];<span class="hljs-keyword">return</span>{<span class="hljs-attr">tag</span>:q.bitSlice(d,<span class="hljs-number">0</span>,f),<span class="hljs-attr">data</span>:c}}};sjcl.misc.hmac=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">this</span>.W=b=b||sjcl.hash.sha256;<span class="hljs-keyword">var</span> c=[[],[]],d,e=b.prototype.blockSize/<span class="hljs-number">32</span>;<span class="hljs-keyword">this</span>.w=[<span class="hljs-keyword">new</span> b,<span class="hljs-keyword">new</span> b];a.length&gt;e&amp;&amp;(a=b.hash(a));<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;e;d++)c[<span class="hljs-number">0</span>][d]=a[d]^<span class="hljs-number">909522486</span>,c[<span class="hljs-number">1</span>][d]=a[d]^<span class="hljs-number">1549556828</span>;<span class="hljs-keyword">this</span>.w[<span class="hljs-number">0</span>].update(c[<span class="hljs-number">0</span>]);<span class="hljs-keyword">this</span>.w[<span class="hljs-number">1</span>].update(c[<span class="hljs-number">1</span>]);<span class="hljs-keyword">this</span>.R=<span class="hljs-keyword">new</span> b(<span class="hljs-keyword">this</span>.w[<span class="hljs-number">0</span>])};
sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.aa)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"encrypt on already updated hmac called!"</span>);<span class="hljs-keyword">this</span>.update(a);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.digest(a)};sjcl.misc.hmac.prototype.reset=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.R=<span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.W(<span class="hljs-keyword">this</span>.w[<span class="hljs-number">0</span>]);<span class="hljs-keyword">this</span>.aa=!<span class="hljs-number">1</span>};sjcl.misc.hmac.prototype.update=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.aa=!<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.R.update(a)};sjcl.misc.hmac.prototype.digest=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">this</span>.R.finalize(),a=(<span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.W(<span class="hljs-keyword">this</span>.w[<span class="hljs-number">1</span>])).update(a).finalize();<span class="hljs-keyword">this</span>.reset();<span class="hljs-keyword">return</span> a};
sjcl.misc.pbkdf2=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d,e</span>)</span>{c=c||<span class="hljs-number">1E4</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>&gt;d||<span class="hljs-number">0</span>&gt;c)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"invalid params to pbkdf2"</span>);<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> a&amp;&amp;(a=sjcl.codec.utf8String.toBits(a));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> b&amp;&amp;(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=<span class="hljs-keyword">new</span> e(a);<span class="hljs-keyword">var</span> f,g,h,k,l=[],n=sjcl.bitArray;<span class="hljs-keyword">for</span>(k=<span class="hljs-number">1</span>;<span class="hljs-number">32</span>*l.length&lt;(d||<span class="hljs-number">1</span>);k++){e=f=a.encrypt(n.concat(b,[k]));<span class="hljs-keyword">for</span>(g=<span class="hljs-number">1</span>;g&lt;c;g++)<span class="hljs-keyword">for</span>(f=a.encrypt(f),h=<span class="hljs-number">0</span>;h&lt;f.length;h++)e[h]^=f[h];l=l.concat(e)}d&amp;&amp;(l=n.clamp(l,d));<span class="hljs-keyword">return</span> l};
sjcl.prng=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">this</span>.c=[<span class="hljs-keyword">new</span> sjcl.hash.sha256];<span class="hljs-keyword">this</span>.m=[<span class="hljs-number">0</span>];<span class="hljs-keyword">this</span>.P=<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.H={};<span class="hljs-keyword">this</span>.N=<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.U={};<span class="hljs-keyword">this</span>.Z=<span class="hljs-keyword">this</span>.f=<span class="hljs-keyword">this</span>.o=<span class="hljs-keyword">this</span>.ha=<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.b=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>];<span class="hljs-keyword">this</span>.h=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>];<span class="hljs-keyword">this</span>.L=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.M=a;<span class="hljs-keyword">this</span>.D=!<span class="hljs-number">1</span>;<span class="hljs-keyword">this</span>.K={<span class="hljs-attr">progress</span>:{},<span class="hljs-attr">seeded</span>:{}};<span class="hljs-keyword">this</span>.u=<span class="hljs-keyword">this</span>.ga=<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.I=<span class="hljs-number">1</span>;<span class="hljs-keyword">this</span>.J=<span class="hljs-number">2</span>;<span class="hljs-keyword">this</span>.ca=<span class="hljs-number">0x10000</span>;<span class="hljs-keyword">this</span>.T=[<span class="hljs-number">0</span>,<span class="hljs-number">48</span>,<span class="hljs-number">64</span>,<span class="hljs-number">96</span>,<span class="hljs-number">128</span>,<span class="hljs-number">192</span>,<span class="hljs-number">0x100</span>,<span class="hljs-number">384</span>,<span class="hljs-number">512</span>,<span class="hljs-number">768</span>,<span class="hljs-number">1024</span>];<span class="hljs-keyword">this</span>.da=<span class="hljs-number">3E4</span>;<span class="hljs-keyword">this</span>.ba=<span class="hljs-number">80</span>};
sjcl.prng.prototype={<span class="hljs-attr">randomWords</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c=[],d;d=<span class="hljs-keyword">this</span>.isReady(b);<span class="hljs-keyword">var</span> e;<span class="hljs-keyword">if</span>(d===<span class="hljs-keyword">this</span>.u)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.notReady(<span class="hljs-string">"generator isn't seeded"</span>);<span class="hljs-keyword">if</span>(d&amp;<span class="hljs-keyword">this</span>.J){d=!(d&amp;<span class="hljs-keyword">this</span>.I);e=[];<span class="hljs-keyword">var</span> f=<span class="hljs-number">0</span>,g;<span class="hljs-keyword">this</span>.Z=e[<span class="hljs-number">0</span>]=(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).valueOf()+<span class="hljs-keyword">this</span>.da;<span class="hljs-keyword">for</span>(g=<span class="hljs-number">0</span>;<span class="hljs-number">16</span>&gt;g;g++)e.push(<span class="hljs-number">0x100000000</span>*<span class="hljs-built_in">Math</span>.random()|<span class="hljs-number">0</span>);<span class="hljs-keyword">for</span>(g=<span class="hljs-number">0</span>;g&lt;<span class="hljs-keyword">this</span>.c.length&amp;&amp;(e=e.concat(<span class="hljs-keyword">this</span>.c[g].finalize()),f+=<span class="hljs-keyword">this</span>.m[g],<span class="hljs-keyword">this</span>.m[g]=<span class="hljs-number">0</span>,d||!(<span class="hljs-keyword">this</span>.P&amp;<span class="hljs-number">1</span>&lt;&lt;g));g++);<span class="hljs-keyword">this</span>.P&gt;=<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-keyword">this</span>.c.length&amp;&amp;(<span class="hljs-keyword">this</span>.c.push(<span class="hljs-keyword">new</span> sjcl.hash.sha256),<span class="hljs-keyword">this</span>.m.push(<span class="hljs-number">0</span>));<span class="hljs-keyword">this</span>.f-=f;f&gt;<span class="hljs-keyword">this</span>.o&amp;&amp;(<span class="hljs-keyword">this</span>.o=
f);<span class="hljs-keyword">this</span>.P++;<span class="hljs-keyword">this</span>.b=sjcl.hash.sha256.hash(<span class="hljs-keyword">this</span>.b.concat(e));<span class="hljs-keyword">this</span>.L=<span class="hljs-keyword">new</span> sjcl.cipher.aes(<span class="hljs-keyword">this</span>.b);<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;<span class="hljs-number">4</span>&gt;d&amp;&amp;(<span class="hljs-keyword">this</span>.h[d]=<span class="hljs-keyword">this</span>.h[d]+<span class="hljs-number">1</span>|<span class="hljs-number">0</span>,!<span class="hljs-keyword">this</span>.h[d]);d++);}<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;a;d+=<span class="hljs-number">4</span>)<span class="hljs-number">0</span>===(d+<span class="hljs-number">1</span>)%<span class="hljs-keyword">this</span>.ca&amp;&amp;y(<span class="hljs-keyword">this</span>),e=z(<span class="hljs-keyword">this</span>),c.push(e[<span class="hljs-number">0</span>],e[<span class="hljs-number">1</span>],e[<span class="hljs-number">2</span>],e[<span class="hljs-number">3</span>]);y(<span class="hljs-keyword">this</span>);<span class="hljs-keyword">return</span> c.slice(<span class="hljs-number">0</span>,a)},<span class="hljs-attr">setDefaultParanoia</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===a&amp;&amp;<span class="hljs-string">"Setting paranoia=0 will ruin your security; use it only for testing"</span>!==b)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"Setting paranoia=0 will ruin your security; use it only for testing"</span>);<span class="hljs-keyword">this</span>.M=a},<span class="hljs-attr">addEntropy</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,
b,c</span>)</span>{c=c||<span class="hljs-string">"user"</span>;<span class="hljs-keyword">var</span> d,e,f=(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).valueOf(),g=<span class="hljs-keyword">this</span>.H[c],h=<span class="hljs-keyword">this</span>.isReady(),k=<span class="hljs-number">0</span>;d=<span class="hljs-keyword">this</span>.U[c];<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===d&amp;&amp;(d=<span class="hljs-keyword">this</span>.U[c]=<span class="hljs-keyword">this</span>.ha++);<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===g&amp;&amp;(g=<span class="hljs-keyword">this</span>.H[c]=<span class="hljs-number">0</span>);<span class="hljs-keyword">this</span>.H[c]=(<span class="hljs-keyword">this</span>.H[c]+<span class="hljs-number">1</span>)%<span class="hljs-keyword">this</span>.c.length;<span class="hljs-keyword">switch</span>(<span class="hljs-keyword">typeof</span> a){<span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===b&amp;&amp;(b=<span class="hljs-number">1</span>);<span class="hljs-keyword">this</span>.c[g].update([d,<span class="hljs-keyword">this</span>.N++,<span class="hljs-number">1</span>,b,f,<span class="hljs-number">1</span>,a|<span class="hljs-number">0</span>]);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">"object"</span>:c=<span class="hljs-built_in">Object</span>.prototype.toString.call(a);<span class="hljs-keyword">if</span>(<span class="hljs-string">"[object Uint32Array]"</span>===c){e=[];<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;a.length;c++)e.push(a[c]);a=e}<span class="hljs-keyword">else</span> <span class="hljs-keyword">for</span>(<span class="hljs-string">"[object Array]"</span>!==c&amp;&amp;(k=<span class="hljs-number">1</span>),c=<span class="hljs-number">0</span>;c&lt;a.length&amp;&amp;!k;c++)<span class="hljs-string">"number"</span>!==<span class="hljs-keyword">typeof</span> a[c]&amp;&amp;
(k=<span class="hljs-number">1</span>);<span class="hljs-keyword">if</span>(!k){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===b)<span class="hljs-keyword">for</span>(c=b=<span class="hljs-number">0</span>;c&lt;a.length;c++)<span class="hljs-keyword">for</span>(e=a[c];<span class="hljs-number">0</span>&lt;e;)b++,e=e&gt;&gt;&gt;<span class="hljs-number">1</span>;<span class="hljs-keyword">this</span>.c[g].update([d,<span class="hljs-keyword">this</span>.N++,<span class="hljs-number">2</span>,b,f,a.length].concat(a))}<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===b&amp;&amp;(b=a.length);<span class="hljs-keyword">this</span>.c[g].update([d,<span class="hljs-keyword">this</span>.N++,<span class="hljs-number">3</span>,b,f,a.length]);<span class="hljs-keyword">this</span>.c[g].update(a);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:k=<span class="hljs-number">1</span>}<span class="hljs-keyword">if</span>(k)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.bug(<span class="hljs-string">"random: addEntropy only supports number, array of numbers or string"</span>);<span class="hljs-keyword">this</span>.m[g]+=b;<span class="hljs-keyword">this</span>.f+=b;h===<span class="hljs-keyword">this</span>.u&amp;&amp;(<span class="hljs-keyword">this</span>.isReady()!==<span class="hljs-keyword">this</span>.u&amp;&amp;A(<span class="hljs-string">"seeded"</span>,<span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.o,<span class="hljs-keyword">this</span>.f)),A(<span class="hljs-string">"progress"</span>,<span class="hljs-keyword">this</span>.getProgress()))},
<span class="hljs-attr">isReady</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=<span class="hljs-keyword">this</span>.T[<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==a?a:<span class="hljs-keyword">this</span>.M];<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.o&amp;&amp;<span class="hljs-keyword">this</span>.o&gt;=a?<span class="hljs-keyword">this</span>.m[<span class="hljs-number">0</span>]&gt;<span class="hljs-keyword">this</span>.ba&amp;&amp;(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).valueOf()&gt;<span class="hljs-keyword">this</span>.Z?<span class="hljs-keyword">this</span>.J|<span class="hljs-keyword">this</span>.I:<span class="hljs-keyword">this</span>.I:<span class="hljs-keyword">this</span>.f&gt;=a?<span class="hljs-keyword">this</span>.J|<span class="hljs-keyword">this</span>.u:<span class="hljs-keyword">this</span>.u},<span class="hljs-attr">getProgress</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=<span class="hljs-keyword">this</span>.T[a?a:<span class="hljs-keyword">this</span>.M];<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.o&gt;=a?<span class="hljs-number">1</span>:<span class="hljs-keyword">this</span>.f&gt;a?<span class="hljs-number">1</span>:<span class="hljs-keyword">this</span>.f/a},<span class="hljs-attr">startCollectors</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.D){<span class="hljs-keyword">this</span>.a={<span class="hljs-attr">loadTimeCollector</span>:B(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.ma),<span class="hljs-attr">mouseCollector</span>:B(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.oa),<span class="hljs-attr">keyboardCollector</span>:B(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.la),<span class="hljs-attr">accelerometerCollector</span>:B(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.ea),<span class="hljs-attr">touchCollector</span>:B(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.qa)};<span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.addEventListener)<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"load"</span>,
<span class="hljs-keyword">this</span>.a.loadTimeCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"mousemove"</span>,<span class="hljs-keyword">this</span>.a.mouseCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"keypress"</span>,<span class="hljs-keyword">this</span>.a.keyboardCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"devicemotion"</span>,<span class="hljs-keyword">this</span>.a.accelerometerCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"touchmove"</span>,<span class="hljs-keyword">this</span>.a.touchCollector,!<span class="hljs-number">1</span>);<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">document</span>.attachEvent)<span class="hljs-built_in">document</span>.attachEvent(<span class="hljs-string">"onload"</span>,<span class="hljs-keyword">this</span>.a.loadTimeCollector),<span class="hljs-built_in">document</span>.attachEvent(<span class="hljs-string">"onmousemove"</span>,<span class="hljs-keyword">this</span>.a.mouseCollector),<span class="hljs-built_in">document</span>.attachEvent(<span class="hljs-string">"keypress"</span>,<span class="hljs-keyword">this</span>.a.keyboardCollector);<span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.bug(<span class="hljs-string">"can't attach event"</span>);
<span class="hljs-keyword">this</span>.D=!<span class="hljs-number">0</span>}},<span class="hljs-attr">stopCollectors</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.D&amp;&amp;(<span class="hljs-built_in">window</span>.removeEventListener?(<span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"load"</span>,<span class="hljs-keyword">this</span>.a.loadTimeCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"mousemove"</span>,<span class="hljs-keyword">this</span>.a.mouseCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"keypress"</span>,<span class="hljs-keyword">this</span>.a.keyboardCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"devicemotion"</span>,<span class="hljs-keyword">this</span>.a.accelerometerCollector,!<span class="hljs-number">1</span>),<span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"touchmove"</span>,<span class="hljs-keyword">this</span>.a.touchCollector,!<span class="hljs-number">1</span>)):<span class="hljs-built_in">document</span>.detachEvent&amp;&amp;(<span class="hljs-built_in">document</span>.detachEvent(<span class="hljs-string">"onload"</span>,<span class="hljs-keyword">this</span>.a.loadTimeCollector),<span class="hljs-built_in">document</span>.detachEvent(<span class="hljs-string">"onmousemove"</span>,
<span class="hljs-keyword">this</span>.a.mouseCollector),<span class="hljs-built_in">document</span>.detachEvent(<span class="hljs-string">"keypress"</span>,<span class="hljs-keyword">this</span>.a.keyboardCollector)),<span class="hljs-keyword">this</span>.D=!<span class="hljs-number">1</span>)},<span class="hljs-attr">addEventListener</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">this</span>.K[a][<span class="hljs-keyword">this</span>.ga++]=b},<span class="hljs-attr">removeEventListener</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c,d,e=<span class="hljs-keyword">this</span>.K[a],f=[];<span class="hljs-keyword">for</span>(d <span class="hljs-keyword">in</span> e)e.hasOwnProperty(d)&amp;&amp;e[d]===b&amp;&amp;f.push(d);<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;f.length;c++)d=f[c],<span class="hljs-keyword">delete</span> e[d]},<span class="hljs-attr">la</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{C(<span class="hljs-keyword">this</span>,<span class="hljs-number">1</span>)},<span class="hljs-attr">oa</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b,c;<span class="hljs-keyword">try</span>{b=a.x||a.clientX||a.offsetX||<span class="hljs-number">0</span>,c=a.y||a.clientY||a.offsetY||<span class="hljs-number">0</span>}<span class="hljs-keyword">catch</span>(d){c=b=<span class="hljs-number">0</span>}<span class="hljs-number">0</span>!=b&amp;&amp;<span class="hljs-number">0</span>!=c&amp;&amp;<span class="hljs-keyword">this</span>.addEntropy([b,c],<span class="hljs-number">2</span>,<span class="hljs-string">"mouse"</span>);C(<span class="hljs-keyword">this</span>,<span class="hljs-number">0</span>)},<span class="hljs-attr">qa</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=
a.touches[<span class="hljs-number">0</span>]||a.changedTouches[<span class="hljs-number">0</span>];<span class="hljs-keyword">this</span>.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],<span class="hljs-number">1</span>,<span class="hljs-string">"touch"</span>);C(<span class="hljs-keyword">this</span>,<span class="hljs-number">0</span>)},<span class="hljs-attr">ma</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{C(<span class="hljs-keyword">this</span>,<span class="hljs-number">2</span>)},<span class="hljs-attr">ea</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;<span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.orientation){<span class="hljs-keyword">var</span> b=<span class="hljs-built_in">window</span>.orientation;<span class="hljs-string">"number"</span>===<span class="hljs-keyword">typeof</span> b&amp;&amp;<span class="hljs-keyword">this</span>.addEntropy(b,<span class="hljs-number">1</span>,<span class="hljs-string">"accelerometer"</span>)}a&amp;&amp;<span class="hljs-keyword">this</span>.addEntropy(a,<span class="hljs-number">2</span>,<span class="hljs-string">"accelerometer"</span>);C(<span class="hljs-keyword">this</span>,<span class="hljs-number">0</span>)}};
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">A</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c,d=sjcl.random.K[a],e=[];<span class="hljs-keyword">for</span>(c <span class="hljs-keyword">in</span> d)d.hasOwnProperty(c)&amp;&amp;e.push(d[c]);<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;e.length;c++)e[c](b)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">C</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>&amp;&amp;<span class="hljs-built_in">window</span>.performance&amp;&amp;<span class="hljs-string">"function"</span>===<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.performance.now?a.addEntropy(<span class="hljs-built_in">window</span>.performance.now(),b,<span class="hljs-string">"loadtime"</span>):a.addEntropy((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).valueOf(),b,<span class="hljs-string">"loadtime"</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span>(<span class="hljs-params">a</span>)</span>{a.b=z(a).concat(z(a));a.L=<span class="hljs-keyword">new</span> sjcl.cipher.aes(a.b)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">z</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> b=<span class="hljs-number">0</span>;<span class="hljs-number">4</span>&gt;b&amp;&amp;(a.h[b]=a.h[b]+<span class="hljs-number">1</span>|<span class="hljs-number">0</span>,!a.h[b]);b++);<span class="hljs-keyword">return</span> a.L.encrypt(a.h)}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">B</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{b.apply(a,<span class="hljs-built_in">arguments</span>)}}sjcl.random=<span class="hljs-keyword">new</span> sjcl.prng(<span class="hljs-number">6</span>);
a:<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> D,E,F,G;<span class="hljs-keyword">if</span>(G=<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>&amp;&amp;<span class="hljs-built_in">module</span>.exports){<span class="hljs-keyword">var</span> H;<span class="hljs-keyword">try</span>{H=<span class="hljs-built_in">require</span>(<span class="hljs-string">"crypto"</span>)}<span class="hljs-keyword">catch</span>(a){H=<span class="hljs-literal">null</span>}G=E=H}<span class="hljs-keyword">if</span>(G&amp;&amp;E.randomBytes)D=E.randomBytes(<span class="hljs-number">128</span>),D=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint32Array</span>((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(D)).buffer),sjcl.random.addEntropy(D,<span class="hljs-number">1024</span>,<span class="hljs-string">"crypto['randomBytes']"</span>);<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>&amp;&amp;<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Uint32Array</span>){F=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint32Array</span>(<span class="hljs-number">32</span>);<span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.crypto&amp;&amp;<span class="hljs-built_in">window</span>.crypto.getRandomValues)<span class="hljs-built_in">window</span>.crypto.getRandomValues(F);<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.msCrypto&amp;&amp;<span class="hljs-built_in">window</span>.msCrypto.getRandomValues)<span class="hljs-built_in">window</span>.msCrypto.getRandomValues(F);
<span class="hljs-keyword">else</span> <span class="hljs-keyword">break</span> a;sjcl.random.addEntropy(F,<span class="hljs-number">1024</span>,<span class="hljs-string">"crypto['getRandomValues']"</span>)}}<span class="hljs-keyword">catch</span>(a){<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>&amp;&amp;<span class="hljs-built_in">window</span>.console&amp;&amp;(<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"There was an error collecting entropy from the browser:"</span>),<span class="hljs-built_in">console</span>.log(a))}
sjcl.json={<span class="hljs-attr">defaults</span>:{<span class="hljs-attr">v</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">iter</span>:<span class="hljs-number">1E4</span>,<span class="hljs-attr">ks</span>:<span class="hljs-number">128</span>,<span class="hljs-attr">ts</span>:<span class="hljs-number">64</span>,<span class="hljs-attr">mode</span>:<span class="hljs-string">"ccm"</span>,<span class="hljs-attr">adata</span>:<span class="hljs-string">""</span>,<span class="hljs-attr">cipher</span>:<span class="hljs-string">"aes"</span>},<span class="hljs-attr">ja</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d</span>)</span>{c=c||{};d=d||{};<span class="hljs-keyword">var</span> e=sjcl.json,f=e.g({<span class="hljs-attr">iv</span>:sjcl.random.randomWords(<span class="hljs-number">4</span>,<span class="hljs-number">0</span>)},e.defaults),g;e.g(f,c);c=f.adata;<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> f.salt&amp;&amp;(f.salt=sjcl.codec.base64.toBits(f.salt));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> f.iv&amp;&amp;(f.iv=sjcl.codec.base64.toBits(f.iv));<span class="hljs-keyword">if</span>(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> a&amp;&amp;<span class="hljs-number">100</span>&gt;=f.iter||<span class="hljs-number">64</span>!==f.ts&amp;&amp;<span class="hljs-number">96</span>!==f.ts&amp;&amp;<span class="hljs-number">128</span>!==f.ts||<span class="hljs-number">128</span>!==f.ks&amp;&amp;<span class="hljs-number">192</span>!==f.ks&amp;&amp;<span class="hljs-number">0x100</span>!==f.ks||<span class="hljs-number">2</span>&gt;f.iv.length||
<span class="hljs-number">4</span>&lt;f.iv.length)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"json encrypt: invalid parameters"</span>);<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(<span class="hljs-number">0</span>,f.ks/<span class="hljs-number">32</span>),f.salt=g.salt):sjcl.ecc&amp;&amp;a <span class="hljs-keyword">instanceof</span> sjcl.ecc.elGamal.publicKey&amp;&amp;(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(<span class="hljs-number">0</span>,f.ks/<span class="hljs-number">32</span>));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> b&amp;&amp;(b=sjcl.codec.utf8String.toBits(b));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> c&amp;&amp;(f.adata=c=sjcl.codec.utf8String.toBits(c));g=<span class="hljs-keyword">new</span> sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct=<span class="hljs-string">"ccm"</span>===f.mode&amp;&amp;sjcl.arrayBuffer&amp;&amp;sjcl.arrayBuffer.ccm&amp;&amp;
b <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);<span class="hljs-keyword">return</span> f},<span class="hljs-attr">encrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d</span>)</span>{<span class="hljs-keyword">var</span> e=sjcl.json,f=e.ja.apply(e,<span class="hljs-built_in">arguments</span>);<span class="hljs-keyword">return</span> e.encode(f)},<span class="hljs-attr">ia</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d</span>)</span>{c=c||{};d=d||{};<span class="hljs-keyword">var</span> e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,!<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> f,g;f=b.adata;<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> b.salt&amp;&amp;(b.salt=sjcl.codec.base64.toBits(b.salt));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> b.iv&amp;&amp;(b.iv=sjcl.codec.base64.toBits(b.iv));<span class="hljs-keyword">if</span>(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||<span class="hljs-string">"string"</span>===
<span class="hljs-keyword">typeof</span> a&amp;&amp;<span class="hljs-number">100</span>&gt;=b.iter||<span class="hljs-number">64</span>!==b.ts&amp;&amp;<span class="hljs-number">96</span>!==b.ts&amp;&amp;<span class="hljs-number">128</span>!==b.ts||<span class="hljs-number">128</span>!==b.ks&amp;&amp;<span class="hljs-number">192</span>!==b.ks&amp;&amp;<span class="hljs-number">0x100</span>!==b.ks||!b.iv||<span class="hljs-number">2</span>&gt;b.iv.length||<span class="hljs-number">4</span>&lt;b.iv.length)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"json decrypt: invalid parameters"</span>);<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(<span class="hljs-number">0</span>,b.ks/<span class="hljs-number">32</span>),b.salt=g.salt):sjcl.ecc&amp;&amp;a <span class="hljs-keyword">instanceof</span> sjcl.ecc.elGamal.secretKey&amp;&amp;(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(<span class="hljs-number">0</span>,b.ks/<span class="hljs-number">32</span>));<span class="hljs-string">"string"</span>===<span class="hljs-keyword">typeof</span> f&amp;&amp;(f=sjcl.codec.utf8String.toBits(f));g=<span class="hljs-keyword">new</span> sjcl.cipher[b.cipher](a);f=<span class="hljs-string">"ccm"</span>===
b.mode&amp;&amp;sjcl.arrayBuffer&amp;&amp;sjcl.arrayBuffer.ccm&amp;&amp;b.ct <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>===c.raw?f:sjcl.codec.utf8String.fromBits(f)},<span class="hljs-attr">decrypt</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c,d</span>)</span>{<span class="hljs-keyword">var</span> e=sjcl.json;<span class="hljs-keyword">return</span> e.ia(a,e.decode(b),c,d)},<span class="hljs-attr">encode</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{<span class="hljs-keyword">var</span> b,c=<span class="hljs-string">"{"</span>,d=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span>(b <span class="hljs-keyword">in</span> a)<span class="hljs-keyword">if</span>(a.hasOwnProperty(b)){<span class="hljs-keyword">if</span>(!b.match(<span class="hljs-regexp">/^[a-z0-9]+$/i</span>))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"json encode: invalid property name"</span>);c+=d+<span class="hljs-string">'"'</span>+
b+<span class="hljs-string">'":'</span>;d=<span class="hljs-string">","</span>;<span class="hljs-keyword">switch</span>(<span class="hljs-keyword">typeof</span> a[b]){<span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:<span class="hljs-keyword">case</span> <span class="hljs-string">"boolean"</span>:c+=a[b];<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:c+=<span class="hljs-string">'"'</span>+<span class="hljs-built_in">escape</span>(a[b])+<span class="hljs-string">'"'</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">"object"</span>:c+=<span class="hljs-string">'"'</span>+sjcl.codec.base64.fromBits(a[b],<span class="hljs-number">0</span>)+<span class="hljs-string">'"'</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.bug(<span class="hljs-string">"json encode: unsupported type"</span>);}}<span class="hljs-keyword">return</span> c+<span class="hljs-string">"}"</span>},<span class="hljs-attr">decode</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>)</span>{a=a.replace(<span class="hljs-regexp">/\s/g</span>,<span class="hljs-string">""</span>);<span class="hljs-keyword">if</span>(!a.match(<span class="hljs-regexp">/^\{.*\}$/</span>))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"json decode: this isn't json!"</span>);a=a.replace(<span class="hljs-regexp">/^\{|\}$/g</span>,<span class="hljs-string">""</span>).split(<span class="hljs-regexp">/,/</span>);<span class="hljs-keyword">var</span> b={},c,d;<span class="hljs-keyword">for</span>(c=<span class="hljs-number">0</span>;c&lt;a.length;c++){<span class="hljs-keyword">if</span>(!(d=a[c].match(<span class="hljs-regexp">/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i</span>)))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"json decode: this isn't json!"</span>);
<span class="hljs-literal">null</span>!=d[<span class="hljs-number">3</span>]?b[d[<span class="hljs-number">2</span>]]=<span class="hljs-built_in">parseInt</span>(d[<span class="hljs-number">3</span>],<span class="hljs-number">10</span>):<span class="hljs-literal">null</span>!=d[<span class="hljs-number">4</span>]?b[d[<span class="hljs-number">2</span>]]=d[<span class="hljs-number">2</span>].match(<span class="hljs-regexp">/^(ct|adata|salt|iv)$/</span>)?sjcl.codec.base64.toBits(d[<span class="hljs-number">4</span>]):<span class="hljs-built_in">unescape</span>(d[<span class="hljs-number">4</span>]):<span class="hljs-literal">null</span>!=d[<span class="hljs-number">5</span>]&amp;&amp;(b[d[<span class="hljs-number">2</span>]]=<span class="hljs-string">"true"</span>===d[<span class="hljs-number">5</span>])}<span class="hljs-keyword">return</span> b},<span class="hljs-attr">g</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)</span>{<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===a&amp;&amp;(a={});<span class="hljs-keyword">if</span>(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===b)<span class="hljs-keyword">return</span> a;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> d <span class="hljs-keyword">in</span> b)<span class="hljs-keyword">if</span>(b.hasOwnProperty(d)){<span class="hljs-keyword">if</span>(c&amp;&amp;<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==a[d]&amp;&amp;a[d]!==b[d])<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> sjcl.exception.invalid(<span class="hljs-string">"required parameter overridden"</span>);a[d]=b[d]}<span class="hljs-keyword">return</span> a},<span class="hljs-attr">sa</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c={},d;<span class="hljs-keyword">for</span>(d <span class="hljs-keyword">in</span> a)a.hasOwnProperty(d)&amp;&amp;a[d]!==b[d]&amp;&amp;(c[d]=a[d]);<span class="hljs-keyword">return</span> c},<span class="hljs-attr">ra</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,
b</span>)</span>{<span class="hljs-keyword">var</span> c={},d;<span class="hljs-keyword">for</span>(d=<span class="hljs-number">0</span>;d&lt;b.length;d++)<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==a[b[d]]&amp;&amp;(c[b[d]]=a[b[d]]);<span class="hljs-keyword">return</span> c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> c=sjcl.misc.pa,d;b=b||{};d=b.iter||<span class="hljs-number">1E3</span>;c=c[a]=c[a]||{};d=c[d]=c[d]||{<span class="hljs-attr">firstSalt</span>:b.salt&amp;&amp;b.salt.length?b.salt.slice(<span class="hljs-number">0</span>):sjcl.random.randomWords(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>)};c=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);<span class="hljs-keyword">return</span>{<span class="hljs-attr">key</span>:d[c].slice(<span class="hljs-number">0</span>),<span class="hljs-attr">salt</span>:c.slice(<span class="hljs-number">0</span>)}};
<span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>&amp;&amp;<span class="hljs-built_in">module</span>.exports&amp;&amp;(<span class="hljs-built_in">module</span>.exports=sjcl);<span class="hljs-string">"function"</span>===<span class="hljs-keyword">typeof</span> define&amp;&amp;define([],<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> sjcl});
</code></pre></div>

<div class="tc-tiddler-plugin-info tc-reveal"><p>
</p></div><br>

<hr>

<p>未链接子条目：</p><p><ul class="">无</ul></p>

父条目：

<ul class="">无</ul><p>因为本博客暂不支持评论功能，想要留言还请移步<a class="tc-tiddlylink-external" href="https://www.cnblogs.com/frank3215/p/comments.html" rel="noopener noreferrer" target="_blank">我的博客园</a>。也可以通过<a class="tc-tiddlylink-external" href="mailto:frank3215@163.com" rel="noopener noreferrer" target="_blank">我的邮箱</a><code>frank3215@163.com</code>或<a class="tc-tiddlylink-external" href="https://www.luogu.com.cn/user/73915" rel="noopener noreferrer" target="_blank">我的洛谷帐号</a><code>frank3215</code>私信联系我。</p></div></p>
</section>
</body>
</html>

